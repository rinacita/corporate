/*!
 * vue-thin-modal v1.3.0
 * https://github.com/ktsn/vue-thin-modal
 *
 * Copyright (c) 2017-present katashin
 * Released under the MIT license
 * https://github.com/ktsn/vue-thin-modal/blob/master/LICENSE
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.VueThinModal={})}(this,function(t){"use strict";function m(t,n){if(!t)throw new Error("[vue-thin-modal] "+n)}var r={name:"modal",props:{name:{type:String,required:!0},disableBackdrop:Boolean,preMount:Boolean,backdropTransition:{type:[String,Object],default:function(){return{name:"modal-backdrop"}}},contentTransition:{type:[String,Object],default:function(){return{name:"modal-content"}}}},computed:{current:function(){return this.$modal.currentName},computedBackdropTransition:function(){return"string"==typeof this.contentTransition?{name:this.backdropTransition}:this.backdropTransition},computedContentTransition:function(){return"string"==typeof this.contentTransition?{name:this.contentTransition}:this.contentTransition},eventListners:function(){var e=this,t={};return["before-open","opened","before-close","closed"].forEach(function(n){t[n]=function(t){e.name===t&&e.$emit(n,t)}}),t}},mounted:function(){var n=this,e=this.$modal._getPortal();Object.keys(this.eventListners).forEach(function(t){e.$on(t,n.eventListners[t])}),e.update.apply(e,this._modalDataForPortal)},updated:function(){var t=this.$modal._getPortal();t.update.apply(t,this._modalDataForPortal)},beforeDestroy:function(){var n=this,e=this.$modal._getPortal();e.unregister(this.name),Object.keys(this.eventListners).forEach(function(t){e.$off(t,n.eventListners[t])})},render:function(t){return this._modalDataForPortal=[this.name,{show:!0,backdropTransition:this.computedBackdropTransition,contentTransition:this.computedContentTransition,disableBackdrop:this.disableBackdrop},this.$slots],this.preMount&&this.current!==this.name?t("div",{style:{display:"none"}},this.$slots.default):t()}},a={functional:!0,name:"backdrop",props:{show:Boolean,backdropTransition:Object},render:function(t,n){var e=n.props,o=n.slots,r=e.show;return t("transition",{props:e.backdropTransition},[r&&(o().default||t("div",{staticClass:"modal-backdrop"}))])}},i={functional:!0,name:"modal-content",props:{show:Boolean,disableBackdrop:Boolean,contentTransition:Object},render:function(t,n){var e,o,r,a,i=n.props,s=n.data,c=n.slots,d=s.on||{},u=i.show,l=i.disableBackdrop,p=i.contentTransition,f=(e=c().default||[],m((o=e.filter(function(t){return t.tag})).length<=1,"Modal must have only one child"),o[0]);f&&(r=f.data,a="modal-content",r.staticClass?r.staticClass+=" "+a:r.staticClass=a);var h={props:p,on:d};return t("div",{staticClass:"modal-content-wrapper",attrs:{role:"dialog","aria-hidden":String(!u)},on:{click:function(t){l||t.target===t.currentTarget&&d["click-backdrop"]&&d["click-backdrop"]()}}},[t("transition",h,[u&&f])])}};var s="undefined"!=typeof window;function o(t,n){s&&(document.body.style[t]=n)}var c="modal-open",d={name:"modal-portal",data:function(){return{modals:{}}},computed:{prev:function(){return this.$modal.prevName},current:function(){return this.$modal.currentName}},methods:{update:function(n,t,e){var o=e.default||[];o.forEach(function(t){t.key||(t.data||(t.data={}),t.key=t.data.key=n)}),this.$set(this.modals,n,{props:t,children:o,backdrop:e.backdrop})},unregister:function(t){this.$delete(this.modals,t)}},beforeCreate:function(){this.$modal._setPortal(this)},beforeMount:function(){var e=this;this.$on("click-backdrop",function(){e.$modal.pop()}),this.$on("before-open",function(){if(null!=e.current){var t=s?window.innerWidth-document.documentElement.offsetWidth:null;t&&o("paddingRight",t+"px"),n=c,s&&document.body.classList.add(n)}var n}),this.$on("closed",function(){var t;null==e.current&&(o("paddingRight",""),t=c,s&&document.body.classList.remove(t))})},render:function(t){var n=this,e=this.modals[this.current],o={"before-enter":function(){return n.$emit("before-open",n.current)},"before-leave":function(){return n.$emit("before-close",n.prev)},"after-enter":function(){return n.$emit("opened",n.current)},"after-leave":function(){return n.$emit("closed",n.prev)},"click-backdrop":function(){return n.$emit("click-backdrop")}};return e?u(t,{props:e.props,on:o},e.children,e.backdrop):u(t,{on:o},[])}};function u(t,n,e,o){return t("div",{staticClass:"modal-wrapper"},[t(a,n,o),t(i,n,e)])}function l(t){var n={portal:null};return new t({vueThinModalMediator:!0,data:{stack:[],prevName:null},computed:{currentName:function(){var t=this.stack,n=t[t.length-1];return n&&n.name}},methods:{push:function(t){var n=function(){if(s)return document.activeElement}();n&&n.blur();var e={name:t,focusedElement:n};Object.freeze(e),this.stack.push(e)},pop:function(){var t=this.stack.pop();t&&t.focusedElement&&t.focusedElement.focus()},replace:function(t){this.pop(),this.push(t)},_setPortal:function(t){n.portal=t},_getPortal:function(){return m(n.portal,"You need to put <modal-portal> or set `autoMountPortal: true` plugin option."),n.portal}},watch:{currentName:function(t,n){this.prevName=n}}})}var p=void 0;var n={install:function(t){var n,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(m(p!==t,"Already installed"),p=t,Object.defineProperty(p.prototype,"$modal",{get:function(){return this.$root.$_vueThinModal}}),p.component("modal",r),p.component("modal-portal",d),!1!==e.autoMountPortal){p.prototype.$_vueThinModal=l(p);var o=new(p.extend(d));n=function(){var t;o.$mount(),t=o.$el,s&&document.body.appendChild(t)},s&&document.addEventListener("DOMContentLoaded",n)}else p.mixin({beforeCreate:function(){this.$parent||this.$options.vueThinModalMediator||(this.$_vueThinModal=l(p))}})}};t.Modal=r,t.ModalPortal=d,t.generateMediator=l,t.default=n,Object.defineProperty(t,"__esModule",{value:!0})});
